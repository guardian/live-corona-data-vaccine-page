#%%

import pandas as pd 

df = pd.read_csv('https://vaccinedata.covid19nearme.com.au/data/air.csv')

# 'DATE_AS_AT', 'AIR_95_PLUS_FIRST_DOSE_COUNT', 'AIR_95_PLUS_FIRST_DOSE_PCT', 'AIR_95_PLUS_SECOND_DOSE_COUNT', 'AIR_95_PLUS_SECOND_DOSE_PCT', 'AIR_95_PLUS_FEMALE_PCT', 'AIR_95_PLUS_MALE_PCT', 'AIR_90_94_FIRST_DOSE_COUNT', 'AIR_90_94_FIRST_DOSE_PCT', 'AIR_90_94_SECOND_DOSE_COUNT', 'AIR_90_94_SECOND_DOSE_PCT', 'AIR_90_94_FEMALE_PCT', 'AIR_90_94_MALE_PCT', 'AIR_85_89_FIRST_DOSE_COUNT', 'AIR_85_89_FIRST_DOSE_PCT', 'AIR_85_89_SECOND_DOSE_COUNT', 'AIR_85_89_SECOND_DOSE_PCT', 'AIR_85_89_FEMALE_PCT', 'AIR_85_89_MALE_PCT', 'AIR_80_84_FIRST_DOSE_COUNT', 'AIR_80_84_FIRST_DOSE_PCT', 'AIR_80_84_SECOND_DOSE_COUNT', 'AIR_80_84_SECOND_DOSE_PCT', 'AIR_80_84_FEMALE_PCT', 'AIR_80_84_MALE_PCT', 'AIR_75_79_FIRST_DOSE_COUNT', 'AIR_75_79_FIRST_DOSE_PCT', 'AIR_75_79_SECOND_DOSE_COUNT', 'AIR_75_79_SECOND_DOSE_PCT', 'AIR_75_79_FEMALE_PCT', 'AIR_75_79_MALE_PCT', 'AIR_70_74_FIRST_DOSE_COUNT', 'AIR_70_74_FIRST_DOSE_PCT', 'AIR_70_74_SECOND_DOSE_COUNT', 'AIR_70_74_SECOND_DOSE_PCT', 'AIR_70_74_FEMALE_PCT', 'AIR_70_74_MALE_PCT', 'AIR_65_69_FIRST_DOSE_COUNT', 'AIR_65_69_FIRST_DOSE_PCT', 'AIR_65_69_SECOND_DOSE_COUNT', 'AIR_65_69_SECOND_DOSE_PCT', 'AIR_65_69_FEMALE_PCT', 'AIR_65_69_MALE_PCT', 'AIR_60_64_FIRST_DOSE_COUNT', 'AIR_60_64_FIRST_DOSE_PCT', 'AIR_60_64_SECOND_DOSE_COUNT', 'AIR_60_64_SECOND_DOSE_PCT', 'AIR_60_64_FEMALE_PCT', 'AIR_60_64_MALE_PCT', 'AIR_55_59_FIRST_DOSE_COUNT', 'AIR_55_59_FIRST_DOSE_PCT', 'AIR_55_59_SECOND_DOSE_COUNT', 'AIR_55_59_SECOND_DOSE_PCT', 'AIR_55_59_FEMALE_PCT', 'AIR_55_59_MALE_PCT', 'AIR_50_54_FIRST_DOSE_COUNT', 'AIR_50_54_FIRST_DOSE_PCT', 'AIR_50_54_SECOND_DOSE_COUNT', 'AIR_50_54_SECOND_DOSE_PCT', 'AIR_50_54_FEMALE_PCT', 'AIR_50_54_MALE_PCT', 'AIR_45_49_FIRST_DOSE_COUNT', 'AIR_45_49_FIRST_DOSE_PCT', 'AIR_45_49_SECOND_DOSE_COUNT', 'AIR_45_49_SECOND_DOSE_PCT', 'AIR_45_49_FEMALE_PCT', 'AIR_45_49_MALE_PCT', 'AIR_40_44_FIRST_DOSE_COUNT', 'AIR_40_44_FIRST_DOSE_PCT', 'AIR_40_44_SECOND_DOSE_COUNT', 'AIR_40_44_SECOND_DOSE_PCT', 'AIR_40_44_FEMALE_PCT', 'AIR_40_44_MALE_PCT', 'AIR_35_39_FIRST_DOSE_COUNT', 'AIR_35_39_FIRST_DOSE_PCT', 'AIR_35_39_SECOND_DOSE_COUNT', 'AIR_35_39_SECOND_DOSE_PCT', 'AIR_35_39_FEMALE_PCT', 'AIR_35_39_MALE_PCT', 'AIR_30_34_FIRST_DOSE_COUNT', 'AIR_30_34_FIRST_DOSE_PCT', 'AIR_30_34_SECOND_DOSE_COUNT', 'AIR_30_34_SECOND_DOSE_PCT', 'AIR_30_34_FEMALE_PCT', 'AIR_30_34_MALE_PCT', 'AIR_25_29_FIRST_DOSE_COUNT', 'AIR_25_29_FIRST_DOSE_PCT', 'AIR_25_29_SECOND_DOSE_COUNT', 'AIR_25_29_SECOND_DOSE_PCT', 'AIR_25_29_FEMALE_PCT', 'AIR_25_29_MALE_PCT', 'AIR_20_24_FIRST_DOSE_COUNT', 'AIR_20_24_FIRST_DOSE_PCT', 'AIR_20_24_SECOND_DOSE_COUNT', 'AIR_20_24_SECOND_DOSE_PCT', 'AIR_20_24_FEMALE_PCT', 'AIR_20_24_MALE_PCT', 'AIR_16_19_FIRST_DOSE_COUNT', 'AIR_16_19_FIRST_DOSE_PCT', 'AIR_16_19_SECOND_DOSE_COUNT', 'AIR_16_19_SECOND_DOSE_PCT', 'AIR_16_19_FEMALE_PCT', 'AIR_16_19_MALE_PCT', 'AIR_NSW_16_PLUS_FIRST_DOSE_COUNT', 'AIR_NSW_16_PLUS_FIRST_DOSE_PCT', 'AIR_NSW_16_PLUS_SECOND_DOSE_COUNT', 'AIR_NSW_16_PLUS_SECOND_DOSE_PCT', 'AIR_NSW_16_PLUS_POPULATION', 'AIR_VIC_16_PLUS_FIRST_DOSE_COUNT', 'AIR_VIC_16_PLUS_FIRST_DOSE_PCT', 'AIR_VIC_16_PLUS_SECOND_DOSE_COUNT', 'AIR_VIC_16_PLUS_SECOND_DOSE_PCT', 'AIR_VIC_16_PLUS_POPULATION', 'AIR_QLD_16_PLUS_FIRST_DOSE_COUNT', 'AIR_QLD_16_PLUS_FIRST_DOSE_PCT', 'AIR_QLD_16_PLUS_SECOND_DOSE_COUNT', 'AIR_QLD_16_PLUS_SECOND_DOSE_PCT', 'AIR_QLD_16_PLUS_POPULATION', 'AIR_WA_16_PLUS_FIRST_DOSE_COUNT', 'AIR_WA_16_PLUS_FIRST_DOSE_PCT', 'AIR_WA_16_PLUS_SECOND_DOSE_COUNT', 'AIR_WA_16_PLUS_SECOND_DOSE_PCT', 'AIR_WA_16_PLUS_POPULATION', 'AIR_TAS_16_PLUS_FIRST_DOSE_COUNT', 'AIR_TAS_16_PLUS_FIRST_DOSE_PCT', 'AIR_TAS_16_PLUS_SECOND_DOSE_COUNT', 'AIR_TAS_16_PLUS_SECOND_DOSE_PCT', 'AIR_TAS_16_PLUS_POPULATION', 'AIR_SA_16_PLUS_FIRST_DOSE_COUNT', 'AIR_SA_16_PLUS_FIRST_DOSE_PCT', 'AIR_SA_16_PLUS_SECOND_DOSE_COUNT', 'AIR_SA_16_PLUS_SECOND_DOSE_PCT', 'AIR_SA_16_PLUS_POPULATION', 'AIR_ACT_16_PLUS_FIRST_DOSE_COUNT', 'AIR_ACT_16_PLUS_FIRST_DOSE_PCT', 'AIR_ACT_16_PLUS_SECOND_DOSE_COUNT', 'AIR_ACT_16_PLUS_SECOND_DOSE_PCT', 'AIR_ACT_16_PLUS_POPULATION', 'AIR_NT_16_PLUS_FIRST_DOSE_COUNT', 'AIR_NT_16_PLUS_FIRST_DOSE_PCT', 'AIR_NT_16_PLUS_SECOND_DOSE_COUNT', 'AIR_NT_16_PLUS_SECOND_DOSE_PCT', 'AIR_NT_16_PLUS_POPULATION', 'AIR_NSW_50_PLUS_FIRST_DOSE_COUNT', 'AIR_NSW_50_PLUS_FIRST_DOSE_PCT', 'AIR_NSW_50_PLUS_SECOND_DOSE_COUNT', 'AIR_NSW_50_PLUS_SECOND_DOSE_PCT', 'AIR_NSW_50_PLUS_POPULATION', 'AIR_VIC_50_PLUS_FIRST_DOSE_COUNT', 'AIR_VIC_50_PLUS_FIRST_DOSE_PCT', 'AIR_VIC_50_PLUS_SECOND_DOSE_COUNT', 'AIR_VIC_50_PLUS_SECOND_DOSE_PCT', 'AIR_VIC_50_PLUS_POPULATION', 'AIR_QLD_50_PLUS_FIRST_DOSE_COUNT', 'AIR_QLD_50_PLUS_FIRST_DOSE_PCT', 'AIR_QLD_50_PLUS_SECOND_DOSE_COUNT', 'AIR_QLD_50_PLUS_SECOND_DOSE_PCT', 'AIR_QLD_50_PLUS_POPULATION', 'AIR_WA_50_PLUS_FIRST_DOSE_COUNT', 'AIR_WA_50_PLUS_FIRST_DOSE_PCT', 'AIR_WA_50_PLUS_SECOND_DOSE_COUNT', 'AIR_WA_50_PLUS_SECOND_DOSE_PCT', 'AIR_WA_50_PLUS_POPULATION', 'AIR_TAS_50_PLUS_FIRST_DOSE_COUNT', 'AIR_TAS_50_PLUS_FIRST_DOSE_PCT', 'AIR_TAS_50_PLUS_SECOND_DOSE_COUNT', 'AIR_TAS_50_PLUS_SECOND_DOSE_PCT', 'AIR_TAS_50_PLUS_POPULATION', 'AIR_SA_50_PLUS_FIRST_DOSE_COUNT', 'AIR_SA_50_PLUS_FIRST_DOSE_PCT', 'AIR_SA_50_PLUS_SECOND_DOSE_COUNT', 'AIR_SA_50_PLUS_SECOND_DOSE_PCT', 'AIR_SA_50_PLUS_POPULATION', 'AIR_ACT_50_PLUS_FIRST_DOSE_COUNT', 'AIR_ACT_50_PLUS_FIRST_DOSE_PCT', 'AIR_ACT_50_PLUS_SECOND_DOSE_COUNT', 'AIR_ACT_50_PLUS_SECOND_DOSE_PCT', 'AIR_ACT_50_PLUS_POPULATION', 'AIR_NT_50_PLUS_FIRST_DOSE_COUNT', 'AIR_NT_50_PLUS_FIRST_DOSE_PCT', 'AIR_NT_50_PLUS_SECOND_DOSE_COUNT', 'AIR_NT_50_PLUS_SECOND_DOSE_PCT', 'AIR_NT_50_PLUS_POPULATION', 'AIR_NSW_70_PLUS_FIRST_DOSE_COUNT', 'AIR_NSW_70_PLUS_FIRST_DOSE_PCT', 'AIR_NSW_70_PLUS_SECOND_DOSE_COUNT', 'AIR_NSW_70_PLUS_SECOND_DOSE_PCT', 'AIR_NSW_70_PLUS_POPULATION', 'AIR_VIC_70_PLUS_FIRST_DOSE_COUNT', 'AIR_VIC_70_PLUS_FIRST_DOSE_PCT', 'AIR_VIC_70_PLUS_SECOND_DOSE_COUNT', 'AIR_VIC_70_PLUS_SECOND_DOSE_PCT', 'AIR_VIC_70_PLUS_POPULATION', 'AIR_QLD_70_PLUS_FIRST_DOSE_COUNT', 'AIR_QLD_70_PLUS_FIRST_DOSE_PCT', 'AIR_QLD_70_PLUS_SECOND_DOSE_COUNT', 'AIR_QLD_70_PLUS_SECOND_DOSE_PCT', 'AIR_QLD_70_PLUS_POPULATION', 'AIR_WA_70_PLUS_FIRST_DOSE_COUNT', 'AIR_WA_70_PLUS_FIRST_DOSE_PCT', 'AIR_WA_70_PLUS_SECOND_DOSE_COUNT', 'AIR_WA_70_PLUS_SECOND_DOSE_PCT', 'AIR_WA_70_PLUS_POPULATION', 'AIR_TAS_70_PLUS_FIRST_DOSE_COUNT', 'AIR_TAS_70_PLUS_FIRST_DOSE_PCT', 'AIR_TAS_70_PLUS_SECOND_DOSE_COUNT', 'AIR_TAS_70_PLUS_SECOND_DOSE_PCT', 'AIR_TAS_70_PLUS_POPULATION', 'AIR_SA_70_PLUS_FIRST_DOSE_COUNT', 'AIR_SA_70_PLUS_FIRST_DOSE_PCT', 'AIR_SA_70_PLUS_SECOND_DOSE_COUNT', 'AIR_SA_70_PLUS_SECOND_DOSE_PCT', 'AIR_SA_70_PLUS_POPULATION', 'AIR_ACT_70_PLUS_FIRST_DOSE_COUNT', 'AIR_ACT_70_PLUS_FIRST_DOSE_PCT', 'AIR_ACT_70_PLUS_SECOND_DOSE_COUNT', 'AIR_ACT_70_PLUS_SECOND_DOSE_PCT', 'AIR_ACT_70_PLUS_POPULATION', 'AIR_NT_70_PLUS_FIRST_DOSE_COUNT', 'AIR_NT_70_PLUS_FIRST_DOSE_PCT', 'AIR_NT_70_PLUS_SECOND_DOSE_COUNT', 'AIR_NT_70_PLUS_SECOND_DOSE_PCT', 'AIR_NT_70_PLUS_POPULATION', 'AIR_AUS_16_PLUS_FIRST_DOSE_COUNT', 'AIR_AUS_16_PLUS_FIRST_DOSE_PCT', 'AIR_AUS_16_PLUS_SECOND_DOSE_COUNT', 'AIR_AUS_16_PLUS_SECOND_DOSE_PCT', 'AIR_AUS_16_PLUS_POPULATION', 'AIR_AUS_50_PLUS_FIRST_DOSE_COUNT', 'AIR_AUS_50_PLUS_FIRST_DOSE_PCT', 'AIR_AUS_50_PLUS_SECOND_DOSE_COUNT', 'AIR_AUS_50_PLUS_SECOND_DOSE_PCT', 'AIR_AUS_50_PLUS_POPULATION', 'AIR_AUS_70_PLUS_FIRST_DOSE_COUNT', 'AIR_AUS_70_PLUS_FIRST_DOSE_PCT', 'AIR_AUS_70_PLUS_SECOND_DOSE_COUNT', 'AIR_AUS_70_PLUS_SECOND_DOSE_PCT', 'AIR_AUS_70_PLUS_POPULATION', 'AIR_12_15_FIRST_DOSE_COUNT', 'AIR_12_15_FIRST_DOSE_PCT', 'AIR_12_15_SECOND_DOSE_COUNT', 'AIR_12_15_SECOND_DOSE_PCT', 'AIR_12_15_FEMALE_PCT', 'AIR_12_15_MALE_PCT', 'AIR_NSW_12_15_FIRST_DOSE_COUNT', 'AIR_NSW_12_15_FIRST_DOSE_PCT', 'AIR_NSW_12_15_SECOND_DOSE_COUNT', 'AIR_NSW_12_15_SECOND_DOSE_PCT', 'AIR_NSW_12_15_POPULATION', 'AIR_VIC_12_15_FIRST_DOSE_COUNT', 'AIR_VIC_12_15_FIRST_DOSE_PCT', 'AIR_VIC_12_15_SECOND_DOSE_COUNT', 'AIR_VIC_12_15_SECOND_DOSE_PCT', 'AIR_VIC_12_15_POPULATION', 'AIR_QLD_12_15_FIRST_DOSE_COUNT', 'AIR_QLD_12_15_FIRST_DOSE_PCT', 'AIR_QLD_12_15_SECOND_DOSE_COUNT', 'AIR_QLD_12_15_SECOND_DOSE_PCT', 'AIR_QLD_12_15_POPULATION', 'AIR_WA_12_15_FIRST_DOSE_COUNT', 'AIR_WA_12_15_FIRST_DOSE_PCT', 'AIR_WA_12_15_SECOND_DOSE_COUNT', 'AIR_WA_12_15_SECOND_DOSE_PCT', 'AIR_WA_12_15_POPULATION', 'AIR_TAS_12_15_FIRST_DOSE_COUNT', 'AIR_TAS_12_15_FIRST_DOSE_PCT', 'AIR_TAS_12_15_SECOND_DOSE_COUNT', 'AIR_TAS_12_15_SECOND_DOSE_PCT', 'AIR_TAS_12_15_POPULATION', 'AIR_SA_12_15_FIRST_DOSE_COUNT', 'AIR_SA_12_15_FIRST_DOSE_PCT', 'AIR_SA_12_15_SECOND_DOSE_COUNT', 'AIR_SA_12_15_SECOND_DOSE_PCT', 'AIR_SA_12_15_POPULATION', 'AIR_ACT_12_15_FIRST_DOSE_COUNT', 'AIR_ACT_12_15_FIRST_DOSE_PCT', 'AIR_ACT_12_15_SECOND_DOSE_COUNT', 'AIR_ACT_12_15_SECOND_DOSE_PCT', 'AIR_ACT_12_15_POPULATION', 'AIR_NT_12_15_FIRST_DOSE_COUNT', 'AIR_NT_12_15_FIRST_DOSE_PCT', 'AIR_NT_12_15_SECOND_DOSE_COUNT', 'AIR_NT_12_15_SECOND_DOSE_PCT', 'AIR_NT_12_15_POPULATION', 'VALIDATED', 'URL'

include = [x for x in df if "16_PLUS" in x or "12_15" in x]
include = [x for x in include if "COUNT" in x]
include.insert(0, 'DATE_AS_AT')

df = df[include]
df = df.loc[df['DATE_AS_AT'] == df['DATE_AS_AT'].max()]
# 'AIR_NSW_16_PLUS_FIRST_DOSE_COUNT', 'AIR_NSW_16_PLUS_SECOND_DOSE_COUNT', 
# 'AIR_VIC_16_PLUS_FIRST_DOSE_COUNT', 
# 'AIR_VIC_16_PLUS_SECOND_DOSE_COUNT',
#   'AIR_QLD_16_PLUS_FIRST_DOSE_COUNT', 'AIR_QLD_16_PLUS_FIRST_DOSE_PCT', 
#   'AIR_QLD_16_PLUS_SECOND_DOSE_COUNT', 'AIR_QLD_16_PLUS_SECOND_DOSE_PCT', 
#   'AIR_QLD_16_PLUS_POPULATION', 'AIR_WA_16_PLUS_FIRST_DOSE_COUNT', 
#   'AIR_WA_16_PLUS_FIRST_DOSE_PCT', 'AIR_WA_16_PLUS_SECOND_DOSE_COUNT', 
#   'AIR_WA_16_PLUS_SECOND_DOSE_PCT', 'AIR_WA_16_PLUS_POPULATION', 
#   'AIR_TAS_16_PLUS_FIRST_DOSE_COUNT', 'AIR_TAS_16_PLUS_FIRST_DOSE_PCT', 
#   'AIR_TAS_16_PLUS_SECOND_DOSE_COUNT', 'AIR_TAS_16_PLUS_SECOND_DOSE_PCT',
#    'AIR_TAS_16_PLUS_POPULATION', 'AIR_SA_16_PLUS_FIRST_DOSE_COUNT',
#     'AIR_SA_16_PLUS_FIRST_DOSE_PCT', 'AIR_SA_16_PLUS_SECOND_DOSE_COUNT',
#      'AIR_SA_16_PLUS_SECOND_DOSE_PCT', 'AIR_SA_16_PLUS_POPULATION', 'AIR_ACT_16_PLUS_FIRST_DOSE_COUNT',
#  'AIR_ACT_16_PLUS_FIRST_DOSE_PCT', 'AIR_ACT_16_PLUS_SECOND_DOSE_COUNT', 'AIR_ACT_16_PLUS_SECOND_DOSE_PCT', 'A
#%%

states = ['NSW', "ACT", "VIC", "QLD", "TAS","SA", "_NT", "WA"]

listo = []

for state in states:
    cols = [x for x in include if state in x]
    cols.insert(0, 'DATE_AS_AT')
    inter = df[cols]
    
    nammo = state
    if state == "_NT":
        nammo = "NT"
    inter.columns = ['Date', '16_PLUS_FIRST_DOSE_COUNT', '16_PLUS_SECOND_DOSE_COUNT', '12_15_FIRST_DOSE_COUNT', '12_15_SECOND_DOSE_COUNT']    
    inter['State'] = nammo
    listo.append(inter)

    # print(inter)
    # print(cols)
    # inter = df.loc[df[]]

final = pd.concat(listo)

with open('Archive/indig_latest_stats.csv', "w") as f:
    final.to_csv(f, index=False, header=True)